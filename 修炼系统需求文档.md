# 修炼系统需求文档

## 1. 系统概述

修炼系统是游戏的核心玩法之一，允许玩家通过持续修炼提升自身境界和实力。系统模拟修仙世界的修炼过程，包括灵气积累、境界突破等环节。修炼系统完全由后端管理，前端仅负责展示修炼状态和进度。

## 2. 核心功能

### 2.1 灵气积累
- 玩家可以持续获得灵气值
- 灵气值增长速度受多种因素影响（境界、装备、灵宠等）
- 灵气值用于境界突破

### 2.2 境界突破
- 玩家达到一定灵气值后可以突破到更高境界
- 不同境界有不同属性加成
- 突破有一定成功率，失败不消耗资源但会获得顿悟值

### 2.3 顿悟机制
- 突破失败时获得顿悟值
- 顿悟值可以提高下次突破成功率
- 顿悟值随时间缓慢衰减

## 3. 境界体系

### 3.1 境界等级
1. 练气期(1-9层)
2. 筑基期(1-9层)
3. 金丹期(1-9层)
4. 元婴期(1-9层)
5. 化神期(1-9层)
6. 返虚期(1-9层)
7. 合体期(1-9层)
8. 大乘期(1-9层)
9. 渡劫期(1-9层)
10. 散仙期(1-9层)
11. 仙人期(1-9层)
12. 真仙期(1-9层)
13. 金仙期(1-9层)
14. 太乙期(1-9层)
15. 大罗期(1-9层)

### 3.2 境界属性加成
- 每个境界层级提供基础属性加成
- 高境界解锁更多游戏功能
- 境界影响装备穿戴要求

## 4. 数据结构

### 4.1 玩家修炼数据
- cultivation: 当前灵气值
- realm: 当前境界
- insight: 顿悟值
- cultivationRate: 修炼速度加成
- lastCultivationUpdate: 上次灵气更新时间

## 5. API接口设计

### 5.1 获取修炼数据
- 接口地址：GET `/api/player/cultivation`
- 请求参数：无
- 返回数据：玩家当前修炼状态

### 5.2 执行修炼
- 接口地址：POST `/api/player/cultivation/cultivate`
- 请求参数：无
- 返回数据：修炼结果及更新后的状态

### 5.3 境界突破
- 接口地址：POST `/api/player/cultivation/breakthrough`
- 请求参数：无
- 返回数据：突破结果及更新后的状态

## 6. 前后端职责划分

### 6.1 后端职责
- 管理玩家修炼状态和数据
- 计算灵气增长速度和突破成功率
- 处理修炼和突破逻辑
- 维护顿悟值机制
- 提供完整的API接口

### 6.2 前端职责
- 展示修炼状态和进度条
- 提供修炼和突破操作按钮
- 显示境界信息和属性加成
- 展示顿悟值状态

## 7. 注意事项

1. 所有修炼计算和状态管理均由后端负责
2. 前端不应自行计算灵气增长或突破结果
3. 需要定期同步修炼数据以确保准确性
4. 突破成功率和顿悟值计算应考虑多种因素