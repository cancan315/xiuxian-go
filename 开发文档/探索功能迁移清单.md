# æ¢ç´¢åŠŸèƒ½åç«¯è¿ç§»æ¸…å•

## âœ… å®Œæˆçš„å·¥ä½œ

### åç«¯å®ç°
- [x] åˆ›å»º `/internal/exploration/models.go` - æ•°æ®æ¨¡å‹å®šä¹‰
  - ExplorationEvent, EventChoice
  - ExplorationRequest/Response
  - EventChoiceRequest/Response
  - Herb, PillRecipe, PlayerStatsç­‰ç»“æ„ä½“

- [x] åˆ›å»º `/internal/exploration/config.go` - æ¸¸æˆé…ç½®
  - HerbQualities (5ä¸ªå“è´¨ç­‰çº§)
  - HerbConfigs (15ç§çµè‰)
  - PillRecipes (12ä¸ªä¸¹è¯é…æ–¹)
  - å“è´¨è®¡ç®—å‡½æ•°

- [x] åˆ›å»º `/internal/exploration/service.go` - ä¸šåŠ¡é€»è¾‘
  - ExplorationService æœåŠ¡ç±»
  - StartExploration() æ–¹æ³•
  - HandleEventChoice() æ–¹æ³•
  - 8ç§éšæœºäº‹ä»¶è§¦å‘æ–¹æ³•

- [x] åˆ›å»º `/internal/http/handlers/exploration/exploration.go` - HTTPå¤„ç†å™¨
  - StartExploration ç«¯ç‚¹
  - HandleEventChoice ç«¯ç‚¹
  - è¯·æ±‚å‚æ•°éªŒè¯å’Œæ—¥å¿—è®°å½•

- [x] æ›´æ–° `/internal/http/router/router.go`
  - æ³¨å†Œ /api/exploration è·¯ç”±ç»„
  - æ·»åŠ ä¸¤ä¸ªPOSTç«¯ç‚¹

### å‰ç«¯è°ƒæ•´
- [x] æ›´æ–° `/src/views/Exploration.vue`
  - ç§»é™¤ Web Worker ç›¸å…³ä»£ç 
  - æ·»åŠ  API è°ƒç”¨æ–¹æ³•
  - æ›´æ–°äº‹ä»¶å¤„ç†é€»è¾‘
  - ç®€åŒ–ä¸ºçº¯UIå±•ç¤º

- [x] ç§»é™¤è¿‡æ—¶çš„äº‹ä»¶ç³»ç»Ÿå¯¼å…¥
  - åˆ é™¤ triggerRandomEvent å¯¼å…¥
  - åˆ é™¤ eventTypes å¸¸é‡ä½¿ç”¨
  - åˆ é™¤ getRealmName å¯¼å…¥

## ğŸ”„ APIç«¯ç‚¹

### POST /api/exploration/start
**è¯·æ±‚:**
```json
{
  "duration": 10000
}
```

**å“åº”:**
```json
{
  "success": true,
  "events": [
    {
      "type": "spirit_stone_found",
      "description": "[çµæ³‰]å¶é‡ä¸€å¤„å¤©ç„¶çµæ³‰ã€‚",
      "amount": 60,
      "choices": [
        {"text": "ç»§ç»­æ¢ç´¢", "value": "continue"}
      ]
    }
  ],
  "log": "[äº‹ä»¶]å‘ç°äº†60çµçŸ³ï¼"
}
```

### POST /api/exploration/event-choice
**è¯·æ±‚:**
```json
{
  "eventType": "spirit_stone_found",
  "choice": "continue"
}
```

**å“åº”:**
```json
{
  "success": true,
  "rewards": {
    "type": "spirit_stone",
    "message": "è·å¾—äº†çµçŸ³",
    "amount": 60
  }
}
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. åç«¯ç¼–è¯‘æµ‹è¯•
```bash
cd server-go
go build -o test-build ./cmd/server
# åº”è¯¥ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯
```

### 2. åç«¯å¯åŠ¨æµ‹è¯•
```bash
# ç¡®ä¿PostgreSQLå’ŒRedisæ­£åœ¨è¿è¡Œ
cd server-go
go run ./cmd/server
# åº”è¯¥è¾“å‡º: Go server is running on :3000
```

### 3. APIåŠŸèƒ½æµ‹è¯•
```bash
# è·å–è®¤è¯token (å‡è®¾å·²æœ‰ç”¨æˆ·)
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "test", "password": "password"}' \
  | jq '.data.token'

# å¼€å§‹æ¢ç´¢
curl -X POST http://localhost:3000/api/exploration/start \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"duration": 10000}'

# åº”è¯¥è¿”å›æ¢ç´¢ç»“æœï¼ŒåŒ…å«äº‹ä»¶åˆ—è¡¨
```

### 4. å‰ç«¯UIæµ‹è¯•
```bash
# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev

# è®¿é—® http://localhost:2025
# è¿›å…¥æ¢ç´¢é¡µé¢
# ç‚¹å‡»"å¼€å§‹æ¢ç´¢"æŒ‰é’®
# åº”è¯¥æ˜¾ç¤ºæ¢ç´¢æ—¥å¿—å’Œéšæœºäº‹ä»¶
# é€‰æ‹©äº‹ä»¶é€‰é¡¹åº”è¯¥æœ‰åé¦ˆ
```

## ğŸ“Š æ•°æ®æµéªŒè¯

### æ£€æŸ¥ç‚¹
- [ ] ç©å®¶å‘èµ·æ¢ç´¢è¯·æ±‚ â†’ åç«¯æ¥æ”¶
- [ ] åç«¯è®¡ç®—å¹¸è¿å€¼ â†’ è§¦å‘éšæœºäº‹ä»¶
- [ ] åç«¯è¿”å›äº‹ä»¶æ•°æ® â†’ å‰ç«¯æ˜¾ç¤ºå¼¹çª—
- [ ] ç©å®¶é€‰æ‹©äº‹ä»¶é€‰é¡¹ â†’ å‰ç«¯å‘é€é€‰æ‹©
- [ ] åç«¯å¤„ç†é€‰æ‹© â†’ æ›´æ–°æ•°æ®åº“
- [ ] æ•°æ®åº“æ›´æ–°æˆåŠŸ â†’ ç©å®¶æ•°æ®åŒæ­¥

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. ç¼–è¯‘é”™è¯¯: package not found**
```bash
# è§£å†³: æ›´æ–°ä¾èµ–
cd server-go
go mod download
go mod tidy
```

**2. æ•°æ®åº“è¿æ¥é”™è¯¯**
```bash
# æ£€æŸ¥PostgreSQLæ˜¯å¦è¿è¡Œ
# æ£€æŸ¥ .env ä¸­çš„æ•°æ®åº“é…ç½®
# ç¡®ä¿åˆå§‹åŒ–äº†æ•°æ®åº“è¡¨ (init.sql)
```

**3. APIè¿”å›401 Unauthorized**
```bash
# æ£€æŸ¥tokenæ˜¯å¦æœ‰æ•ˆ
# æ£€æŸ¥ä¸­é—´ä»¶è®¤è¯æ˜¯å¦æ­£ç¡®é…ç½®
# ç¡®ä¿Authorizationå¤´æ ¼å¼: "Bearer TOKEN"
```

**4. å‰ç«¯APIè°ƒç”¨å¤±è´¥**
```bash
# æ£€æŸ¥CORSé…ç½®
# æ£€æŸ¥APIä»£ç†é…ç½® (vite.config.js)
# æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
```

## ğŸ“ é…ç½®æ–‡ä»¶æ£€æŸ¥

### server-go/.env
```
PORT=3000
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=password
DB_NAME=xiuxian_db
REDIS_URL=redis://localhost:6379
JWT_SECRET=your-secret-key
```

### vite.config.js ä»£ç†é…ç½®
```javascript
server: {
  proxy: {
    '/api': {
      target: 'http://localhost:3000',
      changeOrigin: true
    }
  }
}
```

## ğŸ¯ å…³é”®éªŒæ”¶æ ‡å‡†

- [x] åç«¯ä»£ç ç¼–è¯‘é€šè¿‡ï¼Œæ— ç¼–è¯‘é”™è¯¯
- [ ] APIç«¯ç‚¹åŠŸèƒ½æ­£å¸¸ï¼Œè¿”å›æ­£ç¡®çš„æ•°æ®æ ¼å¼
- [ ] å‰ç«¯èƒ½æˆåŠŸè°ƒç”¨APIå¹¶æ˜¾ç¤ºç»“æœ
- [ ] ç©å®¶æ•°æ®æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
- [ ] äº‹ä»¶æ—¥å¿—å®Œæ•´è®°å½•
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼Œæœ‰é€‚å½“çš„error message
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´ï¼Œæ˜“äºç»´æŠ¤
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ (å“åº”æ—¶é—´ < 200ms)

## ğŸš€ éƒ¨ç½²æ£€æŸ¥

### ç”Ÿäº§ç¯å¢ƒå‰ç½®æ¡ä»¶
- [ ] åç«¯ç¼–è¯‘æˆåŠŸ
- [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬å·²æ‰§è¡Œ
- [ ] Redisç¼“å­˜å·²å¯åŠ¨
- [ ] æ—¥å¿—é…ç½®æ­£ç¡® (log level è®¾ä¸º INFO)
- [ ] CORSç­–ç•¥é…ç½®æ­£ç¡®
- [ ] APIé€Ÿç‡é™åˆ¶é…ç½®
- [ ] é”™è¯¯ç›‘æ§å’Œå‘Šè­¦å·²é…ç½®

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åç«¯æ¢ç´¢ç³»ç»Ÿå®ç°æŒ‡å—](./åç«¯æ¢ç´¢ç³»ç»Ÿå®ç°æŒ‡å—.md)
- [åŸå§‹é¡¹ç›®æ¶æ„](./é¡¹ç›®æ¶æ„ä¸è®¾è®¡.md)
- æœåŠ¡å™¨é…ç½®: `/server-go/cmd/server/main.go`
- æ•°æ®åº“schema: `/server-go/init.sql`

## ğŸ” å®‰å…¨æ€§æ£€æŸ¥

- [x] API ç«¯ç‚¹å·²æ·»åŠ è®¤è¯ä¸­é—´ä»¶
- [ ] è¾“å…¥å‚æ•°å·²éªŒè¯ (duration èŒƒå›´)
- [ ] ç”¨æˆ·ID éš”ç¦»ï¼Œé˜²æ­¢è·¨ç”¨æˆ·è®¿é—®
- [ ] æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨å‚æ•°åŒ–é˜²æ­¢SQLæ³¨å…¥
- [ ] é”™è¯¯ä¿¡æ¯ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯

## ğŸ’¡ åç»­ä¼˜åŒ–

### çŸ­æœŸ (1-2å‘¨)
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] æ·»åŠ é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

### ä¸­æœŸ (1ä¸ªæœˆ)
- [ ] äº‹ä»¶ç³»ç»Ÿæ‰©å±• (æ›´å¤šäº‹ä»¶ç±»å‹)
- [ ] éšæœºç‰©å“æ‰è½ç³»ç»Ÿ
- [ ] éš¾åº¦ç­‰çº§ç³»ç»Ÿ

### é•¿æœŸ (3-6ä¸ªæœˆ)
- [ ] WebSocketå®æ—¶äº‹ä»¶æ¨é€
- [ ] ç©å®¶æ’è¡Œæ¦œä¸å¯¹æ¯”
- [ ] äº‹ä»¶é“¾å¼è§¦å‘ç³»ç»Ÿ
- [ ] å›¾å½¢åŒ–ä»ªè¡¨æ¿

